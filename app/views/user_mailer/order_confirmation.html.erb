<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Commande confirmée #<%= @order.id %> - <%= @app_name %></title>
</head>
<body>
  <div style="<%= email_wrapper_style %>">
    <div style="<%= email_container_style %>">

      <!-- Header Section -->
      <div style="<%= email_header_style('success') %>">
        <div style="<%= email_logo_style %>">🛍️</div>
        <h1 style="<%= email_header_title_style %>">Commande confirmée !</h1>
        <p style="<%= email_header_subtitle_style %>">Merci pour votre achat sur <%= @app_name %></p>
      </div>

      <!-- Main Content -->
      <div style="<%= email_content_style %>">
        <h2 style="<%= email_content_title_style %>">
          Bonjour <%= @user.first_name || @user.email.split('@').first %>,
        </h2>

        <p style="<%= email_content_text_style %>">
          <strong>Votre commande a été confirmée avec succès ! 🎉</strong>
        </p>

        <p style="<%= email_content_text_style %>">
          Voici le récapitulatif de votre commande :
        </p>

        <!-- Order Summary Box -->
        <div style="<%= email_info_box_style('info') %>">
          <h4 style="margin: 0 0 15px 0; font-size: 18px;">
            📋 Commande #<%= @order.id %>
          </h4>
          <p style="margin: 0 0 10px 0;"><strong>Date :</strong> <%= @order.created_at.strftime("%d/%m/%Y à %H:%M") %></p>
          <p style="margin: 0 0 10px 0;"><strong>Statut :</strong> <span style="color: #28a745; font-weight: bold;">Confirmée</span></p>
          <p style="margin: 0;"><strong>Total :</strong> <span style="font-size: 18px; font-weight: bold;"><%= number_to_currency(@total_price, unit: "€", separator: ",") %></span></p>
        </div>

        <!-- Order Items -->
        <h3 style="color: #2d3748; font-size: 20px; margin: 30px 0 15px 0;">
          📸 Vos photos achetées
        </h3>

        <% @order_items.each_with_index do |order_item, index| %>
          <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; margin: 10px 0; background-color: #f8f9fa;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <div>
                <h4 style="margin: 0 0 5px 0; font-size: 16px; color: #2d3748;">
                  <%= order_item.item.title %>
                </h4>
                <p style="margin: 0; color: #6c757d; font-size: 14px;">
                  <%= order_item.item.description %>
                </p>
              </div>
              <div style="text-align: right;">
                <span style="font-size: 16px; font-weight: bold; color: #28a745;">
                  <%= number_to_currency(order_item.unit_price, unit: "€", separator: ",") %>
                </span>
              </div>
            </div>
          </div>
        <% end %>

        <!-- Access Button -->
        <div style="text-align: center; margin: 30px 0;">
          <a href="<%= @order_url %>" style="<%= email_button_style('success') %>">
            Accéder à mes photos 📥
          </a>
        </div>

        <!-- Download Instructions -->
        <div style="<%= email_info_box_style('success') %>">
          <h4 style="margin: 0 0 10px 0; font-size: 18px;">
            📥 Comment accéder à vos photos ?
          </h4>
          <ol style="margin: 0; padding-left: 20px;">
            <li>Connectez-vous à votre compte <%= @app_name %></li>
            <li>Allez dans "Mes Achats" depuis votre profil</li>
            <li>Téléchargez vos photos en haute qualité</li>
            <li>Profitez de vos adorables chats ! 🐱</li>
          </ol>
        </div>

        <!-- Support Info -->
        <div style="<%= email_security_notice_style %>">
          <h4 style="<%= email_security_title_style %>">
            💬 Besoin d'aide ?
          </h4>
          <p style="<%= email_security_text_style %>">
            Notre équipe support est disponible pour vous aider :
            <a href="mailto:support@kittenlovers.com" style="color: #1976d2;">support@kittenlovers.com</a>
          </p>
        </div>

        <p style="<%= email_content_text_style %>">
          Merci de faire confiance à <%= @app_name %> pour vos moments de bonheur félin !
          N'hésitez pas à partager vos photos préférées avec vos amis. 🐾
        </p>

        <p style="<%= email_content_text_style %>">
          Félinnement vôtre,<br>
          <strong>L'équipe <%= @app_name %></strong> 🐱
        </p>
      </div>

      <!-- Footer -->
      <div style="<%= email_footer_style %>">
        <p style="<%= email_footer_text_style %>">
          <strong><%= @app_name %></strong> - Commande #<%= @order.id %>
        </p>
        <p style="<%= email_footer_text_style %>">
          <a href="<%= root_url %>" style="<%= email_footer_link_style %>">Accueil</a> |
          <a href="<%= @order_url %>" style="<%= email_footer_link_style %>">Ma Commande</a> |
          <a href="<%= root_url %>profile" style="<%= email_footer_link_style %>">Mon Profil</a> |
          <a href="mailto:support@kittenlovers.com" style="<%= email_footer_link_style %>">Support</a>
        </p>
        <p style="font-size: 12px; color: rgba(255, 255, 255, 0.6);">
          Confirmation envoyée à <%= @user.email %>
        </p>
      </div>

    </div>
  </div>
</body>
</html>
